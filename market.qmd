---
title: "Strawberry-Market"
format: html
editor: visual
---

## Strawberry-Market

Chenyi Wang, La Su, Zijing Zhao.

## Introduction

This project explores trends in the U.S. strawberry market using data from the USDA/NASS. The analysis focuses on three key variables: **market price**, **market value**, and **market supply**. Our goal is to understand how these factors have changed over time and how they relate to one another. We cleaned and merged multiple datasets to create a consistent dataset for exploratory data analysis (EDA).

## Clean Data

Before conducting analysis, we first cleaned and merged three separate datasets: **market price**, **market value**, and **market supply**. Missing or inconsistent records were removed to ensure comparability across all years. Column names were standardized, and data types were adjusted to numeric where appropriate. Finally, all three datasets were merged by year to create a single consistent dataset.

1.Set up

```{r}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
knitr::opts_knit$set(root.dir = "~/Downloads/strawberry")  
library(tidyverse)
library(knitr)
library(kableExtra)
library(stringr)
options(scipen = 999) 
```

2.Read data

```{r}
setwd("~/Downloads/strawberry")
price  <- read_csv("market_price_received.csv")
supply <- read_csv("marketsupply.csv")
value  <- read_csv("marketvalue.csv")

glimpse(price)
glimpse(supply)
glimpse(value)
```

3.Clean data

```{r}
library(stringr)
library(dplyr)
clean_strawberry <- function(df) {
  df %>%
    mutate(across(where(is.character), str_trim)) %>%
    select(where(~ !all(is.na(.)) & n_distinct(., na.rm = TRUE) > 1)) %>%
    
    mutate(
      Value = str_replace_all(Value, ",", ""),
      Value = str_remove_all(Value, "\\(D\\)|\\(Z\\)|\\(NA\\)|\\*|\\(X\\)"),
      Value = str_trim(Value),
      Value = suppressWarnings(as.numeric(Value))
    ) %>%

    { if(any(grepl("CV", names(.), ignore.case = TRUE))) {
        rename_with(., ~ "CV", matches("CV")) %>% 
          mutate(CV = suppressWarnings(as.numeric(CV)))
      } else . } %>%
    filter(!is.na(Value))
}

supply_clean <- clean_strawberry(supply)
value_clean  <- clean_strawberry(value)

library(readr)
write_csv(supply_clean, "/Users/zzjing/Downloads/strawberry/marketsupply_clean.csv")
write_csv(value_clean,  "/Users/zzjing/Downloads/strawberry/marketvalue_clean.csv")

library(dplyr)

old <- read_csv("marketsupply_clean.csv")
new <- read_csv("marketsupply2.csv")

new_clean <- new %>%
  select(Year, Period, State, `State ANSI`, Value) %>%
  mutate(
    Value = na_if(Value, " (D)"),
    Value = gsub(",", "", Value),
    Value = as.numeric(Value)
  )

supply_all <- bind_rows(old, new_clean) %>%
  arrange(Year, State)

summary(supply_all$Year)
distinct(supply_all, Year) %>% arrange(Year)
sum(is.na(supply_all$Value))
supply_all_clean <- supply_all %>%
  filter(!is.na(Value))
supply_all %>%
  summarise(total = sum(Value, na.rm = TRUE))
write.csv(supply_all, "marketsupply_all_cleaned.csv", row.names = FALSE)
```

4.Data and Methods

Data were downloaded from USDA NASS Quick Stats for years 1998–2024 (national level) and 1998–2018 (state level). The datasets include both national and state‐specific statistics for fresh-market strawberries. Cleaning steps included: Selecting relevant variables (Year, State, Data Item, Value). Removing non-numeric entries (e.g., (D) for withheld data). Converting price and production values to numeric format. Filtering out rows with missing or zero values. Aggregating prices and total market value by year.

## Analysis

## 1.price

```{r}
library(dplyr)
library(readr)

straw_price <- read_csv("~/Downloads/strawberry/market_price_received.csv")

glimpse(straw_price)
head(straw_price)
straw_price_clean <- straw_price %>%
  select(Year, State, `Data Item`, Value) %>%
  rename(Price_CWT = Value)

straw_price_clean <- straw_price_clean %>%
  mutate(
    Price_CWT = as.numeric(gsub("[^0-9.]", "", Price_CWT)) 
  ) %>%
  filter(!is.na(Price_CWT)) %>%                   
  arrange(Year, State)   
glimpse(straw_price_clean)
```

```{r}
library(ggplot2)

price_trend <- straw_price_clean %>%
  group_by(Year) %>%
  summarize(mean_price = mean(Price_CWT, na.rm = TRUE))

ggplot(price_trend, aes(x = Year, y = mean_price)) +
  geom_line(color = "skyblue", linewidth = 1.2) +
  geom_point(size = 2) +
  labs(
    title = "Average U.S. Strawberry Price Received (Fresh Market)",
    subtitle = "Measured in $ per CWT (100 lbs)",
    x = "Year", y = "Average Price ($/CWT)"
  ) +
  theme_minimal()
```

U.S. Strawberry Market Price Trend (1998–2024) From 1998 to 2024, the average price received by U.S. strawberry farmers for fresh-market sales shows a long-term upward trend with short-term fluctuations: Between 1998 and 2010, prices increased from about \$85 to nearly \$180 per CWT, showing strong growth in market value and demand. From 2011 to 2018, prices fluctuated but remained high, staying in the \$160–180 per CWT range. A sharp decline occurred around 2019–2020, dropping below \$120 per CWT, likely due to production surpluses, weather impacts, or broader market disruptions. Since 2021, prices have rebounded and stabilized around \$140–150 per CWT, suggesting recovery but not a return to the earlier peak levels. Overall, the long-term trend reflects a maturing and competitive market where technological improvements, production efficiency, and global supply dynamics influence farmgate strawberry prices.

```{r}
top_states <- c("CALIFORNIA", "FLORIDA", "OREGON", "NORTH CAROLINA")

ggplot(straw_price_clean %>% filter(State %in% top_states),
       aes(x = Year, y = Price_CWT, color = State)) +
  geom_line(linewidth = 1) +
  geom_point(size = 2) +
  labs(
    title = "Strawberry Prices by State (Fresh Market)",
    y = "Price Received ($/CWT)",
    x = "Year"
  ) +
  theme_minimal()
```

From 1998 to 2018, strawberry prices in both Oregon and North Carolina increased substantially, but their levels and volatility differed: Oregon consistently received higher prices (often \>\$150 per CWT) than North Carolina. This reflects Oregon’s smaller, high-value fresh-market production and regional demand. North Carolina’s prices started much lower (around \$60–80 per CWT) and rose gradually, narrowing the gap by the late 2010s to roughly \$150 per CWT. Oregon’s line shows larger swings, suggesting greater sensitivity to yield variation or market supply. Both states share an upward trend, indicating growth in prices for fresh strawberries over the two-decade period. Overall, Oregon’s premium pricing and North Carolina’s steady catch-up highlight how regional market structures and production scales shape strawberry price patterns across the U.S.

**CONCLUSION:**

Overall, U.S. strawberry prices in the fresh market have shown an upward trend since the late 1990s, rising from around \$90 to \$140–150 per CWT. At the state level, Oregon consistently received higher prices than North Carolina, reflecting differences in production scale and market quality. Although prices fluctuated, they have generally stabilized in recent years, suggesting a mature and resilient market.

## 2.supply

```{r}
library(dplyr)
library(ggplot2)
library(readr)

supply_all <- read_csv("marketsupply_all_cleaned.csv")

annual_total <- supply_all %>%
  group_by(Year) %>%
  summarise(total_value = sum(Value, na.rm = TRUE))

ggplot(annual_total, aes(x = Year, y = total_value)) +
  geom_line(size = 1.2, color = "#e75480") +
  geom_point(size = 2, color = "#e75480") +
  theme_minimal(base_size = 13) +
  labs(title = "U.S. Strawberry Market Supply (1998–2024)",
       x = "Year",
       y = "Total Production (CWT)")
```

This line chart displays the **total national strawberry supply** over the period 1998–2024. The production shows a general upward trend until around 2010, followed by sharp fluctuations that suggest significant changes in market or environmental conditions. The recent years indicate a recovery and relative stabilization of national strawberry output.

```{r}
top_states <- supply_all %>%
  group_by(State) %>%
  summarise(avg_value = mean(Value, na.rm = TRUE)) %>%
  arrange(desc(avg_value)) %>%
  slice(1:5) %>%
  pull(State)

supply_top <- supply_all %>%
  filter(State %in% top_states)

ggplot(supply_top, aes(x = Year, y = Value, color = State)) +
  geom_line(size = 1.2) +
  theme_minimal(base_size = 13) +
  labs(title = "Top 5 Strawberry-Producing States (1998–2024)",
       x = "Year",
       y = "Production (CWT)",
       color = "State")
```

This graph compares production trends across the **five leading strawberry-producing states** in the U.S. California clearly dominates the national supply throughout the observed period, while Florida and North Carolina contribute at much smaller scales. The “Other States” category rises slightly in later years, indicating a modest diversification of production beyond traditional growing regions.

**CONCLUSION:**

The combined dataset integrates USDA strawberry market supply records from **1998–2015** and **2016–2024**, ensuring a complete and continuous timeline for trend analysis. The merge was necessary because each file covered a different period of the same variable — total state-level strawberry production — and combining them allowed for a unified long-term view of supply changes across decades.

As shown in **Figure 1**, total U.S. strawberry production has fluctuated substantially over time, with notable peaks around **2009–2010** and **2017**, followed by a recent moderate increase after 2020. These variations likely reflect both climatic and market-driven factors affecting harvest volumes.\
**Figure 2** highlights the dominance of **California**, which consistently accounts for the vast majority of national production. **Florida** and **North Carolina** contribute much smaller shares, while production in other states remains comparatively minor.

Overall, the merged dataset provides a comprehensive picture of long-term supply dynamics in the U.S. strawberry market, enabling more robust analysis and interpretation.

## 3.value

```{r}
library(dplyr)
library(ggplot2)
library(readr)

value_all <- read_csv("~/Downloads/strawberry/marketvalue_clean.csv")

annual_value <- value_all %>%
  group_by(Year) %>%
  summarise(total_value = sum(Value, na.rm = TRUE))

ggplot(annual_value, aes(x = Year, y = total_value)) +
  geom_line(size = 1.2, color = "#8E44AD") +
  geom_point(size = 2, color = "#8E44AD") +
  theme_minimal(base_size = 13) +
  labs(
    title = "U.S. Strawberry Market Value (1998–2024)",
    x = "Year",
    y = "Total Value (USD)"
  )
```

This line chart presents the **total annual market value** of U.S. strawberries over the past 25 years. It shows the overall growth of the industry, with a sharp rise after 2010, a dip around 2017, and recovery in recent years. The pattern highlights the increasing economic importance of strawberry production nationwide.

```{r}
state_value <- value_all %>%
  group_by(State) %>%
  summarise(mean_value = mean(Value, na.rm = TRUE)) %>%
  arrange(desc(mean_value))

ggplot(state_value, aes(x = reorder(State, mean_value), y = mean_value)) +
  geom_col(fill = "#AF7AC5") +
  coord_flip() +
  theme_minimal(base_size = 13) +
  labs(
    title = "Average Strawberry Market Value by State (1998–2024)",
    x = "State",
    y = "Average Value (USD)"
  )
```

\
This horizontal bar chart compares the **average market value** of strawberry production among U.S. states. California dominates the industry by a large margin, followed by Florida and the category “Other States.” The visualization emphasizes the **regional concentration** of strawberry value, showing that economic activity in this market is heavily centered in California.

------------------------------------------------------------------------

```{r}
california_value <- value_all %>% filter(State == "CALIFORNIA")

ggplot(california_value, aes(x = Year, y = Value)) +
  geom_line(size = 1.2, color = "#BB2649") +
  geom_point(size = 2, color = "#BB2649") +
  theme_minimal(base_size = 13) +
  labs(
    title = "California Strawberry Market Value (1998–2024)",
    x = "Year",
    y = "Value (USD)"
  )
```

This line chart focuses specifically on **California**, the nation’s primary strawberry producer. It demonstrates a steady and consistent increase in market value from 1998 to 2015, followed by several sharp fluctuations, suggesting the state’s strong yet volatile market performance. The trend reinforces California’s critical role in sustaining the national strawberry economy.

**CONCLUSION:**

The strawberry market value analysis provides a comprehensive overview of economic trends in the U.S. strawberry industry from **1998 to 2024**. Overall, the total market value shows a strong upward trajectory with notable fluctuations around 2017 and 2020, indicating possible impacts from climatic variation, market shifts, or production adjustments.\
California remains the clear leader, accounting for the vast majority of national value, followed by Florida and a small contribution from other states. The growing total value and regional concentration suggest that the U.S. strawberry industry has become increasingly valuable yet regionally dependent over time.

## **Summary**

Across all three dimensions—**price, supply, and value**—the U.S. strawberry market from **1998 to 2024** demonstrates both growth and volatility.\
Production and market value have generally increased over time, reflecting the expanding scale and economic importance of the strawberry industry. However, noticeable fluctuations suggest that **external influences** such as climate variation, labor costs, and market demand periodically disrupted stability.\
California consistently remains the dominant contributor in both production and market value, underscoring the state's **central role and dependence** within the national strawberry supply chain.\
Overall, these findings highlight a market that is **strong, regionally concentrated, yet sensitive to external pressures**, emphasizing the importance of long-term sustainability and diversification strategies in the U.S. strawberry sector.

## Reference

Data Source: USDA National Agricultural Statistics Service (NASS).\
<https://www.nass.usda.gov/>
